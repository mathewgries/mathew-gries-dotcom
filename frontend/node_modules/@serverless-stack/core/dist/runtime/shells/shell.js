#!/bin/node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const child_process_1 = require("child_process");
const { SST_START, SST_BUILD } = process.env;
if (!SST_START)
    throw Error("SST_START set");
if (!SST_BUILD)
    throw Error("SST_BUILD not set");
const build = JSON.parse(Buffer.from(SST_BUILD, "base64").toString());
function start() {
    child_process_1.execSync(`${build.command} ${build.args.join(" ")}`, {
        stdio: "inherit",
        env: {
            ...process.env,
            ...build.environment,
        },
    });
    const result = child_process_1.spawn(SST_START, [], {
        ...process.env,
    });
    result.on("close", (code) => {
        console.error(`Child process exited with code ${code}`);
        start();
    });
}
start();
